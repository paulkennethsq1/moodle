/**
 * Edition form reponsivity with total weight calculation and badges deletion.
 * @copyright  2022 Astor Bizard
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_completion_levels/editform",["jquery","core/ajax","core/notification"],(function($,ajax,notification){return{setupActivitites:function(){var $trackingmodeselect=$('[name="config_trackingmethod"]'),updateMessages=function(){$('[data-block-completion-levels-role="nocompletion-message"]').toggle("0"==$trackingmodeselect.val()),$('[data-block-completion-levels-role="nograde-message"]').toggle("1"==$trackingmodeselect.val())};$trackingmodeselect.change(updateMessages),updateMessages(),$('[data-block-completion-levels-role="trackall"]').click((function(){$('[data-block-completion-levels-role="trackactivity-checkbox"][data-block-completion-levels-section="'+$(this).data("block-completion-levels-section")+'"]:not([disabled])').prop("checked",$(this).data("block-completion-levels-dotrack")).change(),M.form.updateFormState($(this).closest("form").attr("id"))}));var $totalweightmessage=$("<div>",{class:"d-inline-block text-info ml-1"}).html(M.util.get_string("totalweight","block_completion_levels","<span></span>")),updateTotalWeight=function(){var count=0;$('[data-block-completion-levels-role="activityweight-text"]:not([disabled])').each((function(){count+=Number($(this).val())})),$totalweightmessage.find("span").html(count)};$trackingmodeselect.after($totalweightmessage),setInterval(updateTotalWeight,1e3),$('[data-block-completion-levels-role="activityweight-text"]').focus((function(){$totalweightmessage.insertAfter($(this)),updateTotalWeight()})).blur((function(){$totalweightmessage.insertAfter($trackingmodeselect)})).on("input",updateTotalWeight),$('[data-block-completion-levels-role="trackactivity-checkbox"]').change(updateTotalWeight)},setupCustomBadges:function(contextid){var $deletebutton=$('[data-block-completion-levels-role="delete-custom-pix"]');$deletebutton.click((function(e){M.util.show_confirm_dialog(e,{message:M.util.get_string("deletebadgeconfirmation","block_completion_levels"),callback:function(){ajax.call([{methodname:"block_completion_levels_delete_custom_pix",args:{contextid:contextid,draftitemid:$('input[name="config_levels_pix"]').val()},done:function(){$('.pix-preview[data-source="custom"]').remove(),$deletebutton.remove(),document.querySelector("fieldset[id^=id_config_levels_pix] .fp-path-folder-name").click()},fail:notification.exception}])}})})).show()}}}));

//# sourceMappingURL=editform.min.js.map