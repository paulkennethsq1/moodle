{"version":3,"file":"user_list.min.js","sources":["../src/user_list.js"],"sourcesContent":["define(['jquery', 'core/ajax', 'core/str','core/url', 'https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js'], \r\n    function($, ajax, str,moodleurl) {\r\n    \r\n    var index = {\r\n        dom: {\r\n            main: null,\r\n        },\r\n\r\n        variables: {\r\n            dataTableReference: null,\r\n        },\r\n\r\n        actions: {\r\n            getString: function(id) {\r\n                index.variables.id = id;\r\n                str.get_strings([\r\n                ]).done(function() {\r\n                    index.init();\r\n                });\r\n            },\r\n        },\r\n\r\n        init: function() {\r\n        \r\n            index.variables.dataTableReference = $('#userTable').DataTable({\r\n                responsive: true,\r\n                serverSide: true,\r\n                processing: true,\r\n                pageLength: 10,\r\n                order: [[0, \"DESC\"]], \r\n                ajax: function(data, callback, settings) {  \r\n                    var courseid = index.variables.id;\r\n                    console.log(\"Course ID:\", courseid);\r\n                    var promises = ajax.call([{\r\n                        methodname: \"local_reports_get_users\",\r\n                        args: { courseid: courseid }\r\n                    }]);\r\n                \r\n                    promises[0].done(function(response) {\r\n                        console.log(\"Response from AJAX:\", response);\r\n                \r\n                        if (typeof callback === \"function\") {\r\n                            callback({ data: response.users || [] }); // Ensure it's an array\r\n                        } else {\r\n                            console.error(\"Callback is not a function!\", callback);\r\n                        }\r\n                    }).fail(function(jqXHR, textStatus, errorThrown) {\r\n                        console.error(\"AJAX Error:\", textStatus, errorThrown, jqXHR.responseText);\r\n                        if (typeof callback === \"function\") {\r\n                            callback({ data: [] }); \r\n                        }\r\n                    });\r\n                },\r\n                \r\n                columns: [\r\n                    { \r\n                        data: \"id\",\r\n                        visible: false\r\n                     },\r\n                    { \r\n                        data: \"firstname\",\r\n                        render: function(data, type, row) {\r\n                            return data + \" \" + row.lastname;\r\n                        }\r\n                    },\r\n                    { data: \"email\" },\r\n                    { data: \"Coursestatus\" },\r\n                    { data: \"startdate\" },\r\n                    { data: \"completiondate\" },\r\n                    { data: \"grade\" },\r\n                    \r\n                    { \r\n                        data: \"id\",\r\n                        orderable: false,\r\n                        searchable: false,\r\n                        render: function(data, type, row) {\r\n                            return `\r\n                                <i class=\"fa fa-eye view\" data-value=\"${data}\" title=\"view\" aria-hidden=\"true\"></i> \r\n                                \r\n                            `;\r\n                        }\r\n                    }\r\n                ]\r\n            });\r\n\r\n            $('#userTable tbody').on('click', '.view', function() {\r\n                var userId = $(this).data('value'); \r\n                window.location = moodleurl.relativeUrl(\r\n                    '/local/reports/user_report.php?id=' + userId\r\n                );\r\n            });\r\n            \r\n        },\r\n    };\r\n\r\n    return {\r\n        init: index.actions.getString,\r\n    };\r\n});\r\n"],"names":["define","$","ajax","str","moodleurl","index","dom","main","variables","dataTableReference","actions","getString","id","get_strings","done","init","DataTable","responsive","serverSide","processing","pageLength","order","data","callback","settings","courseid","console","log","call","methodname","args","response","users","error","fail","jqXHR","textStatus","errorThrown","responseText","columns","visible","render","type","row","lastname","orderable","searchable","on","userId","this","window","location","relativeUrl"],"mappings":"AAAAA,OAAM,0BAAC,CAAC,SAAU,YAAa,WAAW,WAAY,kEAClD,SAASC,EAAGC,KAAMC,IAAIC,WAEtB,IAAIC,MAAQ,CACRC,IAAK,CACDC,KAAM,MAGVC,UAAW,CACPC,mBAAoB,MAGxBC,QAAS,CACLC,UAAW,SAASC,IAChBP,MAAMG,UAAUI,GAAKA,GACrBT,IAAIU,YAAY,IACbC,MAAK,WACJT,MAAMU,MACV,GACJ,GAGJA,KAAM,WAEFV,MAAMG,UAAUC,mBAAqBR,EAAE,cAAce,UAAU,CAC3DC,YAAY,EACZC,YAAY,EACZC,YAAY,EACZC,WAAY,GACZC,MAAO,CAAC,CAAC,EAAG,SACZnB,KAAM,SAASoB,KAAMC,SAAUC,UAC3B,IAAIC,SAAWpB,MAAMG,UAAUI,GAC/Bc,QAAQC,IAAI,aAAcF,UACXvB,KAAK0B,KAAK,CAAC,CACtBC,WAAY,0BACZC,KAAM,CAAEL,SAAUA,aAGb,GAAGX,MAAK,SAASiB,UACtBL,QAAQC,IAAI,sBAAuBI,UAEX,mBAAbR,SACPA,SAAS,CAAED,KAAMS,SAASC,OAAS,KAEnCN,QAAQO,MAAM,8BAA+BV,SAEpD,IAAEW,MAAK,SAASC,MAAOC,WAAYC,aAChCX,QAAQO,MAAM,cAAeG,WAAYC,YAAaF,MAAMG,cACpC,mBAAbf,UACPA,SAAS,CAAED,KAAM,IAEzB,GACH,EAEDiB,QAAS,CACL,CACIjB,KAAM,KACNkB,SAAS,GAEb,CACIlB,KAAM,YACNmB,OAAQ,SAASnB,KAAMoB,KAAMC,KACzB,OAAOrB,KAAO,IAAMqB,IAAIC,QAC5B,GAEJ,CAAEtB,KAAM,SACR,CAAEA,KAAM,gBACR,CAAEA,KAAM,aACR,CAAEA,KAAM,kBACR,CAAEA,KAAM,SAER,CACIA,KAAM,KACNuB,WAAW,EACXC,YAAY,EACZL,OAAQ,SAASnB,KAAMoB,KAAMC,KACzB,MAAO,2EACqCrB,6GAGhD,MAKZrB,EAAE,oBAAoB8C,GAAG,QAAS,SAAS,WACvC,IAAIC,OAAS/C,EAAEgD,MAAM3B,KAAK,SAC1B4B,OAAOC,SAAW/C,UAAUgD,YACxB,qCAAuCJ,OAE/C,GAEJ,GAGJ,MAAO,CACHjC,KAAMV,MAAMK,QAAQC,UAE5B"}